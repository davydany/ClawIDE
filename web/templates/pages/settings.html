{{define "title"}}{{.Title}}{{end}}

{{define "body"}}
<div class="flex h-full" x-data="{ sidebarOpen: false }">
    <!-- Sidebar -->
    <aside class="fixed inset-y-0 left-0 z-50 w-72 bg-gray-900 border-r border-gray-800 transform transition-transform duration-200 lg:relative lg:translate-x-0"
           :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'">
        <div class="flex items-center justify-between h-14 px-4 border-b border-gray-800">
            <a href="/" class="flex items-center gap-2 text-lg font-semibold text-white">
                <span class="text-xl">ü¶Ä</span>
                ClawIDE
                <span class="text-xs font-normal text-gray-500">{{version}}</span>
            </a>
        </div>
        <nav class="p-3 space-y-1">
            <a href="/" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-gray-300 hover:bg-gray-800 hover:text-white">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                </svg>
                Dashboard
            </a>
            <a href="/settings" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-white bg-gray-800">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
                Settings
            </a>
        </nav>
    </aside>

    <!-- Main content -->
    <div class="flex-1 flex flex-col min-w-0">
        <header class="relative z-50 flex items-center h-14 px-4 border-b border-gray-800 bg-gray-900/50 backdrop-blur">
            <button @click="sidebarOpen = true" class="lg:hidden p-1.5 mr-3 rounded text-gray-400 hover:text-white">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
            </button>
            <h1 class="text-sm font-medium text-white">Settings</h1>
            <div class="ml-auto flex items-center gap-2">
                {{template "notification-bell" .}}
            </div>
        </header>

        <main class="flex-1 overflow-y-auto">
            <div class="p-4 lg:p-6 max-w-2xl mx-auto">
                <!-- Breadcrumbs -->
                <nav class="mb-4 text-sm text-gray-400">
                    <a href="/" class="hover:text-white">Dashboard</a>
                    <span class="mx-2 text-gray-600">/</span>
                    <span class="text-white">Settings</span>
                </nav>

                <h2 class="text-xl font-semibold text-white mb-6">Settings</h2>

                <div class="space-y-6">
                    <!-- General Settings -->
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                        <h3 class="text-sm font-medium text-white mb-4">General</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-400 mb-1">Projects Directory</label>
                                <p class="text-sm text-gray-300 font-mono bg-gray-800 px-3 py-2 rounded-lg">{{.Config.ProjectsDir}}</p>
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-1">Max Sessions</label>
                                <p class="text-sm text-gray-300 font-mono bg-gray-800 px-3 py-2 rounded-lg">{{.Config.MaxSessions}}</p>
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-1">Listen Address</label>
                                <p class="text-sm text-gray-300 font-mono bg-gray-800 px-3 py-2 rounded-lg">{{.Config.Host}}:{{.Config.Port}}</p>
                            </div>
                        </div>
                    </div>

                    <!-- AI Agent CLI Configuration -->
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6"
                         x-data="{
                            agentCmd: '{{.Config.AgentCommand}}',
                            agentArgs: '{{.Config.AgentArgs}}',
                            customCmd: '',
                            saving: false,
                            saved: false,
                            showHelp: false,
                            init() {
                                var presets = ['claude', 'codex', 'aider', ''];
                                if (presets.indexOf(this.agentCmd) === -1) {
                                    this.customCmd = this.agentCmd;
                                }
                            },
                            get isPreset() {
                                return ['claude', 'codex', 'aider', ''].indexOf(this.agentCmd) !== -1;
                            },
                            get effectiveCmd() {
                                return this.isPreset ? this.agentCmd : this.customCmd;
                            },
                            save() {
                                var self = this;
                                self.saving = true;
                                self.saved = false;
                                var cmd = self.isPreset ? self.agentCmd : self.customCmd;
                                fetch('/api/settings', {
                                    method: 'PUT',
                                    headers: {'Content-Type': 'application/json'},
                                    body: JSON.stringify({agent_command: cmd, agent_args: self.agentArgs})
                                }).then(function(r) {
                                    if (r.ok) { self.saved = true; setTimeout(function(){ self.saved = false; }, 2000); }
                                }).finally(function() { self.saving = false; });
                            }
                         }">
                        <div class="mb-4">
                            <div class="flex items-start justify-between mb-2">
                                <h3 class="text-sm font-medium text-white">AI Agent CLI Configuration</h3>
                                <button @click="showHelp = !showHelp"
                                        class="text-xs text-indigo-400 hover:text-indigo-300 px-2 py-1 rounded bg-indigo-900/20 hover:bg-indigo-900/40 transition-colors">
                                    <span x-text="showHelp ? 'Hide Help' : 'Show Help'"></span>
                                </button>
                            </div>
                            <p class="text-xs text-gray-400">Configure the AI agent command and options that ClawIDE will auto-launch in new terminal panes.</p>
                        </div>

                        <!-- Help Section -->
                        <div x-show="showHelp" class="mb-4 p-4 bg-gray-800/50 rounded-lg border border-gray-700/50">
                            <div class="text-xs text-gray-300 space-y-2">
                                <p><strong>What is this?</strong> ClawIDE can automatically launch an AI agent in new terminal panes to help with code tasks.</p>
                                <p><strong>Supported Agents:</strong></p>
                                <ul class="list-disc list-inside pl-2 space-y-1">
                                    <li><code class="text-indigo-300">claude</code> - Claude Code (recommended)</li>
                                    <li><code class="text-indigo-300">codex</code> - OpenAI Codex</li>
                                    <li><code class="text-indigo-300">aider</code> - Aider</li>
                                    <li><code class="text-indigo-300">(custom)</code> - Any command path</li>
                                </ul>
                                <p><strong>CLI Arguments:</strong> Add options like <code class="text-indigo-300">--model opus --verbose</code> to customize behavior.</p>
                                <p><strong>Common Options:</strong></p>
                                <ul class="list-disc list-inside pl-2 space-y-1 text-gray-400">
                                    <li><code class="text-indigo-300">--model sonnet|opus|haiku</code> - Choose model</li>
                                    <li><code class="text-indigo-300">--effort low|medium|high</code> - Effort level</li>
                                    <li><code class="text-indigo-300">--permission-mode plan|acceptEdits|default</code> - Permission level</li>
                                    <li><code class="text-indigo-300">-c, --continue</code> - Resume previous session</li>
                                    <li><code class="text-indigo-300">--verbose</code> - Enable verbose output</li>
                                </ul>
                                <p><strong>üìñ Full Reference:</strong> See <code class="text-indigo-300">docs/claude-cli-options.md</code> for complete options list.</p>
                            </div>
                        </div>

                        <div class="space-y-4">
                            <!-- Agent Command Selection -->
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">AI Agent Command</label>
                                <div class="flex items-center gap-2 mb-2">
                                    <select x-model="agentCmd"
                                            class="flex-1 bg-gray-800 text-sm text-gray-300 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:border-indigo-500">
                                        <option value="claude">Claude Code (claude)</option>
                                        <option value="codex">OpenAI Codex (codex)</option>
                                        <option value="aider">Aider (aider)</option>
                                        <option value="">Shell only (no agent)</option>
                                        <template x-if="!isPreset">
                                            <option :value="customCmd" x-text="'Custom: ' + customCmd" selected></option>
                                        </template>
                                    </select>
                                    <button @click="save()" :disabled="saving"
                                            class="px-4 py-2 text-sm bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-700 text-white rounded-lg transition-colors whitespace-nowrap">
                                        <span x-show="!saving && !saved">Save</span>
                                        <span x-show="saving">Saving...</span>
                                        <span x-show="saved" class="text-green-300">‚úì Saved</span>
                                    </button>
                                </div>
                                <p class="text-xs text-gray-500">Command that will auto-launch in new terminal panes.</p>
                            </div>

                            <!-- Custom Command Path -->
                            <div x-show="!isPreset" class="p-3 bg-gray-800/30 rounded-lg border border-gray-700/50">
                                <label class="block text-sm text-gray-400 mb-2">Custom Command Path</label>
                                <input type="text" x-model="customCmd"
                                       placeholder="e.g. /usr/local/bin/claude or /path/to/custom-agent"
                                       class="w-full bg-gray-800 text-sm text-gray-300 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:border-indigo-500 font-mono">
                                <p class="text-xs text-gray-500 mt-1">Provide the full path to your custom AI agent command.</p>
                            </div>

                            <!-- CLI Arguments -->
                            <div x-show="effectiveCmd !== ''">
                                <label class="block text-sm text-gray-400 mb-2">Additional CLI Arguments</label>
                                <input type="text" x-model="agentArgs"
                                       placeholder="e.g. --model opus --effort high --permission-mode acceptEdits"
                                       class="w-full bg-gray-800 text-sm text-gray-300 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:border-indigo-500 font-mono mb-1">
                                <p class="text-xs text-gray-500">Optional flags passed to the agent command. Separate multiple options with spaces.</p>
                            </div>

                            <!-- No Agent Option -->
                            <template x-if="effectiveCmd === ''">
                                <div class="p-3 bg-gray-800/30 rounded-lg border border-gray-700/50">
                                    <p class="text-sm text-gray-400">
                                        <span class="text-yellow-400">‚ÑπÔ∏è</span> Shell only mode: New panes will launch a plain shell without an AI agent.
                                    </p>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Sidebar settings -->
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6"
                         x-data="{ position: '{{.Config.SidebarPosition}}', saving: false }">
                        <h3 class="text-sm font-medium text-white mb-4">Sidebar</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Position</label>
                                <div class="flex items-center gap-2">
                                    <button @click="if(position !== 'left') { saving=true; fetch('/api/settings', {method:'PUT', headers:{'Content-Type':'application/json'}, body:JSON.stringify({sidebar_position:'left'})}).then(r=>{if(r.ok){position='left'}}).finally(()=>saving=false) }"
                                            :disabled="saving"
                                            :class="position === 'left' ? 'bg-indigo-600 text-white border-indigo-500' : 'bg-gray-800 text-gray-300 border-gray-700 hover:border-gray-600 hover:text-white'"
                                            class="flex items-center gap-2 px-4 py-2 text-sm border rounded-lg transition-colors">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"/>
                                        </svg>
                                        Left
                                    </button>
                                    <button @click="if(position !== 'right') { saving=true; fetch('/api/settings', {method:'PUT', headers:{'Content-Type':'application/json'}, body:JSON.stringify({sidebar_position:'right'})}).then(r=>{if(r.ok){position='right'}}).finally(()=>saving=false) }"
                                            :disabled="saving"
                                            :class="position === 'right' ? 'bg-indigo-600 text-white border-indigo-500' : 'bg-gray-800 text-gray-300 border-gray-700 hover:border-gray-600 hover:text-white'"
                                            class="flex items-center gap-2 px-4 py-2 text-sm border rounded-lg transition-colors">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M12 12h8M4 18h16"/>
                                        </svg>
                                        Right
                                    </button>
                                </div>
                                <p class="text-xs text-gray-500 mt-2">Changes apply on next workspace load.</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                        <h3 class="text-sm font-medium text-white mb-4">Onboarding</h3>
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-300">Welcome Tour</p>
                                <p class="text-xs text-gray-500 mt-1">Restart the welcome screen and guided tours</p>
                            </div>
                            <button hx-post="/api/onboarding/reset"
                                    class="px-4 py-2 text-sm bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white border border-gray-700 rounded-lg transition-colors">
                                Restart Onboarding
                            </button>
                        </div>
                    </div>

                    <!-- Software Update -->
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6"
                         x-data="{
                            checking: false,
                            installing: false,
                            state: null,
                            error: '',
                            pollTimer: null,
                            autoUpdate: {{if .Config.AutoUpdateCheck}}true{{else}}false{{end}},
                            togglingAutoUpdate: false,
                            init() {
                                fetch('/api/update/status').then(function(r){ return r.json(); }).then(function(d){
                                    this.state = d;
                                }.bind(this)).catch(function(){});
                            },
                            toggleAutoUpdate() {
                                var self = this;
                                self.togglingAutoUpdate = true;
                                var newVal = !self.autoUpdate;
                                fetch('/api/settings', {
                                    method: 'PUT',
                                    headers: {'Content-Type': 'application/json'},
                                    body: JSON.stringify({auto_update_check: newVal})
                                }).then(function(r){
                                    if (r.ok) { self.autoUpdate = newVal; }
                                }).finally(function(){ self.togglingAutoUpdate = false; });
                            },
                            checkNow() {
                                var self = this;
                                self.checking = true;
                                self.error = '';
                                fetch('/api/update/check').then(function(r){ return r.json(); }).then(function(d){
                                    self.state = d;
                                    if (d.error) { self.error = d.error; }
                                }).catch(function(e){
                                    self.error = 'Failed to check for updates.';
                                }).finally(function(){ self.checking = false; });
                            },
                            applyUpdate() {
                                var self = this;
                                if (!confirm('Update to ' + self.state.latest_version + '? ClawIDE will restart automatically.')) return;
                                self.installing = true;
                                self.error = '';
                                fetch('/api/update/apply', {method:'POST'}).then(function(r){
                                    if (r.status === 202) {
                                        self.startPolling();
                                    } else {
                                        return r.json().then(function(d){ self.error = d.message || 'Update failed.'; self.installing = false; });
                                    }
                                }).catch(function(){
                                    self.error = 'Failed to start update.';
                                    self.installing = false;
                                });
                            },
                            startPolling() {
                                var self = this;
                                var attempts = 0;
                                self.pollTimer = setInterval(function(){
                                    attempts++;
                                    if (attempts > 60) {
                                        clearInterval(self.pollTimer);
                                        self.error = 'Update may have failed. The server did not come back with the expected version after 60 seconds. Please check the logs and refresh manually.';
                                        self.installing = false;
                                        return;
                                    }
                                    fetch('/api/version').then(function(r){
                                        if (r.ok) {
                                            return r.json().then(function(data){
                                                if (data.version === self.state.latest_version) {
                                                    clearInterval(self.pollTimer);
                                                    window.location.reload();
                                                }
                                            });
                                        }
                                    }).catch(function(){});
                                }, 1000);
                            }
                         }">
                        <h3 class="text-sm font-medium text-white mb-4">Software Update</h3>
                        <div class="space-y-3">
                            <!-- Docker detection banner -->
                            <template x-if="state && state.is_docker">
                                <div class="bg-blue-900/30 border border-blue-700/50 rounded-lg p-4">
                                    <div class="flex items-start gap-3">
                                        <svg class="w-5 h-5 text-blue-400 mt-0.5 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                        <div>
                                            <p class="text-sm font-medium text-blue-300">Running in Docker</p>
                                            <p class="text-xs text-gray-400 mt-1">In-app updates are not available in Docker. Pull the latest image to update:</p>
                                            <code class="block text-xs text-blue-200 bg-blue-900/40 px-3 py-2 rounded mt-2 font-mono">docker pull ghcr.io/davydany/clawide:latest</code>
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <!-- Current version -->
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm text-gray-300">Current Version</p>
                                    <p class="text-xs text-gray-500 font-mono mt-0.5">{{.Version}}</p>
                                </div>
                                <template x-if="state && state.is_dev">
                                    <span class="text-xs text-gray-500 bg-gray-800 px-2 py-1 rounded">Dev build - updates disabled</span>
                                </template>
                                <template x-if="state && !state.is_dev && !state.is_docker">
                                    <button @click="checkNow()" :disabled="checking || installing"
                                            class="px-3 py-1.5 text-sm bg-gray-800 hover:bg-gray-700 disabled:bg-gray-800 disabled:text-gray-600 text-gray-300 hover:text-white border border-gray-700 rounded-lg transition-colors">
                                        <span x-show="!checking">Check for Updates</span>
                                        <span x-show="checking" class="flex items-center gap-1.5">
                                            <svg class="animate-spin h-3.5 w-3.5" fill="none" viewBox="0 0 24 24">
                                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                                            </svg>
                                            Checking...
                                        </span>
                                    </button>
                                </template>
                            </div>

                            <!-- Auto-update toggle -->
                            <template x-if="state && !state.is_dev && !state.is_docker">
                                <div class="flex items-center justify-between py-1">
                                    <div>
                                        <p class="text-sm text-gray-300">Automatic Update Checks</p>
                                        <p class="text-xs text-gray-500 mt-0.5">Periodically check for new versions in the background</p>
                                    </div>
                                    <button @click="toggleAutoUpdate()" :disabled="togglingAutoUpdate"
                                            :class="autoUpdate ? 'bg-indigo-600' : 'bg-gray-700'"
                                            class="relative inline-flex h-6 w-11 shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none disabled:opacity-50">
                                        <span :class="autoUpdate ? 'translate-x-5' : 'translate-x-0'"
                                              class="pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"></span>
                                    </button>
                                </div>
                            </template>

                            <!-- Update available banner -->
                            <template x-if="state && state.update_available && !state.is_docker && !installing">
                                <div class="bg-indigo-900/30 border border-indigo-700/50 rounded-lg p-4">
                                    <div class="flex items-start justify-between">
                                        <div>
                                            <p class="text-sm font-medium text-indigo-300">
                                                ClawIDE <span x-text="state.latest_version"></span> is available
                                            </p>
                                            <p class="text-xs text-gray-400 mt-1">
                                                Download size: <span x-text="(state.asset_size / 1024 / 1024).toFixed(1) + ' MB'"></span>
                                            </p>
                                            <a :href="state.release_url" target="_blank" rel="noopener"
                                               class="text-xs text-indigo-400 hover:text-indigo-300 mt-1 inline-block">
                                                View release notes
                                            </a>
                                        </div>
                                        <button @click="applyUpdate()"
                                                class="px-4 py-2 text-sm bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-colors whitespace-nowrap ml-4 animate-pulse shadow-lg shadow-indigo-500/40">
                                            Auto Update to Latest
                                        </button>
                                    </div>
                                </div>
                            </template>

                            <!-- Installing progress -->
                            <template x-if="installing">
                                <div class="bg-yellow-900/20 border border-yellow-700/50 rounded-lg p-4">
                                    <div class="flex items-center gap-3">
                                        <svg class="animate-spin h-5 w-5 text-yellow-400" fill="none" viewBox="0 0 24 24">
                                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                                        </svg>
                                        <div>
                                            <p class="text-sm font-medium text-yellow-300">Installing update...</p>
                                            <p class="text-xs text-gray-400 mt-0.5">ClawIDE will restart automatically. This page will reload when ready.</p>
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <!-- Up to date message -->
                            <template x-if="state && !state.is_dev && !state.is_docker && !state.update_available && state.latest_version && !error">
                                <p class="text-xs text-green-400">ClawIDE is up to date.</p>
                            </template>

                            <!-- Last check time -->
                            <template x-if="state && state.last_check && !state.is_dev">
                                <p class="text-xs text-gray-500">
                                    Last checked: <span x-text="new Date(state.last_check).toLocaleString()"></span>
                                </p>
                            </template>

                            <!-- Error -->
                            <template x-if="error">
                                <p class="text-xs text-red-400" x-text="error"></p>
                            </template>
                        </div>
                    </div>

                    <!-- Claude Code Integration -->
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6"
                         x-data="{ detected: false, hookConfigured: false, loading: true, setting: false }"
                         x-init="fetch('/api/claude/detect').then(r=>r.json()).then(d=>{ detected=d.detected; hookConfigured=d.hook_configured; loading=false; }).catch(()=>{ loading=false; })">
                        <h3 class="text-sm font-medium text-white mb-4">Claude Code Integration</h3>
                        <template x-if="loading">
                            <p class="text-sm text-gray-500">Detecting Claude CLI...</p>
                        </template>
                        <template x-if="!loading && !detected">
                            <div>
                                <p class="text-sm text-gray-400">Claude CLI not found on this system.</p>
                                <p class="text-xs text-gray-500 mt-1">Install Claude Code to enable terminal notifications.</p>
                            </div>
                        </template>
                        <template x-if="!loading && detected">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm text-gray-300">Stop Notifications</p>
                                    <p class="text-xs text-gray-500 mt-1" x-text="hookConfigured ? 'ClawIDE will notify you when Claude Code finishes a task.' : 'Get notified in ClawIDE when Claude Code finishes.'"></p>
                                </div>
                                <template x-if="!hookConfigured">
                                    <button @click="setting=true; fetch('/api/claude/setup-hook',{method:'POST'}).then(r=>{if(r.ok){hookConfigured=true}else{r.text().then(t=>alert(t))}}).finally(()=>setting=false)"
                                            :disabled="setting"
                                            class="px-4 py-2 text-sm bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-700 text-white rounded-lg transition-colors">
                                        Enable
                                    </button>
                                </template>
                                <template x-if="hookConfigured">
                                    <button @click="setting=true; fetch('/api/claude/hook',{method:'DELETE'}).then(()=>{hookConfigured=false}).finally(()=>setting=false)"
                                            :disabled="setting"
                                            class="px-4 py-2 text-sm bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white border border-gray-700 rounded-lg transition-colors">
                                        Disable
                                    </button>
                                </template>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
{{end}}
