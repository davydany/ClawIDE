@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
    --color-bg-primary: #030712;
    --color-bg-secondary: #111827;
    --color-bg-tertiary: #1f2937;
    --color-border: #374151;
    --color-text-primary: #f9fafb;
    --color-text-secondary: #9ca3af;
    --color-accent: #6366f1;
}

/* Safe area for iOS */
.safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
}

/* Terminal container */
.xterm-container {
    width: 100%;
    height: 100%;
}

.xterm-container .xterm {
    padding: 4px;
}

/* Disable browser touch actions on terminal for touch devices */
@media (hover: none) and (pointer: coarse) {
    .xterm-container {
        touch-action: none;
    }
}

/* Touch selection indicator */
.touch-selecting {
    outline: 2px solid rgba(99, 102, 241, 0.6);
    outline-offset: -2px;
}

/* Floating copy button after touch text selection */
.touch-copy-btn {
    position: fixed;
    z-index: 9999;
    padding: 6px 16px;
    font-size: 13px;
    font-weight: 600;
    color: #fff;
    background: #4f46e5;
    border: none;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
}

.touch-copy-btn:active {
    background: #4338ca;
}

/* Scrollbar styling */
::-webkit-scrollbar {
    width: 6px;
    height: 6px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: #374151;
    border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
    background: #4b5563;
}

/* Hide elements with x-cloak before Alpine loads */
[x-cloak] {
    display: none !important;
}

/* File tree styles */
.file-tree-item {
    @apply flex items-center gap-1.5 px-2 py-1 text-sm text-gray-300 hover:bg-gray-800 rounded cursor-pointer;
}

.file-tree-item.active {
    @apply bg-gray-800 text-white;
}

/* Resizable panel handle */
.resize-handle {
    @apply w-1 cursor-col-resize bg-transparent hover:bg-indigo-500/50 transition-colors;
}

/* Pane resize handles */
.pane-resize-handle {
    @apply bg-gray-700 hover:bg-indigo-500 transition-colors flex-shrink-0;
}

.pane-resize-handle[data-direction="horizontal"] {
    @apply w-1 cursor-col-resize;
}

.pane-resize-handle[data-direction="vertical"] {
    @apply h-1 cursor-row-resize;
}

/* Pane toolbar */
.pane-toolbar {
    @apply flex items-center gap-1 px-1 py-0.5 bg-gray-900/80 border-b border-gray-800 text-xs;
}

/* Pane leaf */
.pane-leaf {
    overflow: hidden;
}

.pane-leaf.focused {
    outline: 2px solid rgba(99, 102, 241, 0.6);
    outline-offset: -2px;
}

.pane-leaf.focused > .pane-toolbar {
    @apply border-b-indigo-500/60;
}

/* Editor pane styles */
.editor-pane-leaf {
    overflow: hidden;
}

/* Editor pane header: flex row with tab bar + controls */
.editor-pane-header {
    @apply flex items-center bg-gray-900/80 border-b border-gray-800 text-xs;
}

.editor-pane-header.focused {
    @apply border-b-indigo-500/50;
}

/* Scrollable tab bar */
.editor-tab-bar {
    @apply flex flex-1 min-w-0 overflow-x-auto;
    scrollbar-width: thin;
    scrollbar-color: #374151 transparent;
}

.editor-tab-bar::-webkit-scrollbar {
    height: 3px;
}

.editor-tab-bar::-webkit-scrollbar-track {
    background: transparent;
}

.editor-tab-bar::-webkit-scrollbar-thumb {
    background: #374151;
    border-radius: 2px;
}

/* Individual tab */
.editor-tab {
    @apply flex items-center gap-1.5 px-3 py-1.5 text-gray-400 cursor-pointer whitespace-nowrap flex-shrink-0 border-b-2 border-transparent transition-colors select-none;
}

.editor-tab:hover {
    @apply text-gray-200 bg-gray-800/50;
}

.editor-tab.active {
    @apply bg-gray-800 text-white border-b-indigo-400;
}

.editor-tab .tab-name {
    @apply font-mono text-xs;
}

/* Modified dot: yellow circle */
.editor-tab .modified-dot {
    @apply w-1.5 h-1.5 rounded-full bg-yellow-500 flex-shrink-0;
}

/* Tab close button: hidden by default, visible on tab hover */
.editor-tab .tab-close {
    @apply text-gray-600 hover:text-red-400 text-xs leading-none ml-1 hidden cursor-pointer;
}

.editor-tab:hover .tab-close {
    @apply inline-block;
}

/* Pane controls: split/close buttons */
.editor-pane-controls {
    @apply flex items-center gap-0.5 px-1 flex-shrink-0;
}

/* Editor body: container for tab editor wrappers */
.editor-pane-body {
    @apply flex-1 min-h-0 overflow-hidden relative;
}

/* Each tab's editor wrapper fills the pane body */
.editor-tab-wrapper {
    width: 100%;
    height: 100%;
}

.editor-resize-handle {
    @apply bg-gray-700 hover:bg-indigo-500 transition-colors flex-shrink-0;
}

.editor-resize-handle[data-direction="horizontal"] {
    @apply w-1 cursor-col-resize;
}

.editor-resize-handle[data-direction="vertical"] {
    @apply h-1 cursor-row-resize;
}

/* CodeMirror overrides for dark theme */
.cm-editor {
    height: 100%;
}

.cm-scroller {
    overflow: auto !important;
}

.cm-editor .cm-gutters {
    border-right: 1px solid #374151;
}

/* Modifier keys toolbar - touch devices only */
.modifier-toolbar {
    display: none;
}

@media (hover: none) and (pointer: coarse) {
    .modifier-toolbar {
        @apply flex items-center gap-1 px-2 py-1.5 bg-gray-900 border-t border-gray-800;
        display: flex;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
        padding-bottom: calc(0.375rem + env(safe-area-inset-bottom));
        position: sticky;
        bottom: 0;
        z-index: 10;
        flex-shrink: 0;
    }
}

.modifier-toolbar .modifier-separator {
    @apply w-px h-6 bg-gray-700 mx-1 flex-shrink-0;
}

.modifier-toolbar button {
    @apply flex items-center justify-center rounded text-xs font-medium text-gray-400 bg-gray-800 border border-gray-700 transition-colors select-none;
    min-width: 40px;
    min-height: 36px;
    padding: 4px 8px;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
}

.modifier-toolbar button:active {
    @apply bg-gray-700;
}

/* Modifier active-once state */
.modifier-toolbar button.active-once {
    @apply bg-indigo-600 border-indigo-500 text-white;
}

/* Modifier locked state */
.modifier-toolbar button.locked {
    @apply bg-indigo-600 border-indigo-500 text-white;
    position: relative;
}

.modifier-toolbar button.locked::after {
    content: '';
    position: absolute;
    bottom: 3px;
    left: 50%;
    transform: translateX(-50%);
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background: white;
}

/* Arrow key buttons are slightly smaller */
.modifier-toolbar button[data-key="up"],
.modifier-toolbar button[data-key="down"],
.modifier-toolbar button[data-key="left"],
.modifier-toolbar button[data-key="right"] {
    min-width: 36px;
    padding: 4px 6px;
}

/* Pane name (desktop toolbar) */
.pane-name {
    @apply text-xs text-gray-400 truncate cursor-default;
    max-width: 120px;
    outline: none;
}

.pane-name[contenteditable="true"] {
    @apply text-white bg-gray-800 px-1 rounded;
    cursor: text;
}

/* Carousel (phone layout <768px) */
.carousel-header {
    @apply flex items-center gap-1 px-2 py-1.5 bg-gray-900 border-b border-gray-800;
    flex-shrink: 0;
}

.carousel-nav-btn {
    @apply flex items-center justify-center rounded text-gray-400 transition-colors;
    min-width: 36px;
    min-height: 36px;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
}

.carousel-nav-btn:active {
    @apply bg-gray-800;
}

.carousel-slides {
    overflow: hidden;
}

.carousel-pane-name {
    @apply text-sm text-gray-300 truncate cursor-default;
    max-width: 140px;
    outline: none;
}

.carousel-pane-name[contenteditable="true"] {
    @apply text-white bg-gray-800 px-1 rounded;
    cursor: text;
}

/* Snippet drawer */
.snippet-overlay {
    @apply fixed inset-0 bg-black/50 z-40;
    display: none;
    pointer-events: none;
}

.snippet-overlay.open {
    display: block;
    pointer-events: auto;
}

.snippet-drawer {
    @apply fixed top-0 right-0 h-full bg-gray-900 border-l border-gray-800 z-50 flex flex-col;
    width: 320px;
    transform: translateX(100%);
    transition: transform 0.2s ease-out;
}

.snippet-drawer.open {
    transform: translateX(0);
}

@media (max-width: 640px) {
    .snippet-drawer {
        width: 100%;
    }
}

/* Snippet list items */
.snippet-item {
    @apply px-4 py-2 border-b border-gray-800 hover:bg-gray-800/50 transition-colors;
}

.snippet-item-header {
    @apply flex items-center justify-between gap-2;
}

.snippet-item-name {
    @apply text-sm text-white font-medium truncate;
}

.snippet-item-actions {
    @apply flex items-center gap-1 flex-shrink-0;
}

.snippet-item-actions button {
    @apply p-1 rounded text-gray-500 hover:text-white transition-colors;
}

.snippet-btn-insert:hover {
    @apply text-green-400;
}

.snippet-btn-delete:hover {
    @apply text-red-400;
}

.snippet-item-preview {
    @apply text-xs text-gray-500 mt-1 font-mono truncate;
}

/* Dialog backdrop */
dialog::backdrop {
    background: rgba(0, 0, 0, 0.5);
}

/* Tour overlay and spotlight */
.tour-overlay {
    position: fixed;
    inset: 0;
    z-index: 9997;
    background: rgba(0, 0, 0, 0.6);
}

.tour-spotlight {
    position: fixed;
    z-index: 9998;
    border-radius: 8px;
    box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75);
    background: transparent;
    pointer-events: none;
    transition: all 0.3s ease;
}

.tour-tooltip {
    position: fixed;
    z-index: 9999;
    background: #1f2937;
    border: 1px solid #374151;
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    pointer-events: auto;
    transition: top 0.3s ease, left 0.3s ease;
}
